[tox]
envlist =
    tests
    black
    py37
toxworkdir = ../../.tox
minversion = 3.10.0

[testenv]
setenv =
    DATABASE_URI = sqlite:///:memory:
    FLASK_ENV = development
    SECRET_KEY = testing
deps =
    black
    factory_boy
    flake8
    pytest
    pytest-celery
    pytest-factoryboy
    pytest-flask
    pytest-runner
    -rrequirements.txt
commands =
    flake8 RocketMaven
    black RocketMaven --check
    pytest tests

list_dependencies_command = echo
whitelist_externals = echo

usedevelop = true

[testenv:test]
commands =
    pytest tests {posargs}


[testenv:dev]
setenv =
    DATABASE_URI = sqlite:///tmp/RocketMaven.db
    FLASK_APP = RocketMaven.app:create_app
    FLASK_ENV = development
    SECRET_KEY = testing
usedevelop = true
deps =
    -rrequirements.txt
commands =
    python RocketMaven/manage.py init
    flask run --host=127.0.0.1 --port=5100

[testenv:tidy]
skip_install = true
commands =
    black RocketMaven

[testenv:lint]
skip_install = true
commands =
    flake8 RocketMaven
    black RocketMaven --diff --check

[flake8]
max-line-length = 120
